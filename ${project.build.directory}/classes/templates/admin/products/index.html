<!--products/index.html-->
<!doctype html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">

<head>
    <title>Products</title>

    <!-- jQuery (required by DataTables) -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

    <!-- DataTables + Bootstrap 5 -->
    <link rel="stylesheet" href="https://cdn.datatables.net/2.0.8/css/dataTables.bootstrap5.min.css"/>
    <script src="https://cdn.datatables.net/2.0.8/js/dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/2.0.8/js/dataTables.bootstrap5.min.js"></script>

    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        /* keep action buttons on one line */
        td.col-action, th.col-action{
            white-space: nowrap;
        }

        td.col-action .action-wrap{
            display: inline-flex;
            gap: .4rem;
            align-items: center;
            flex-wrap: nowrap;   /* important: no wrap */
        }

        td.col-action .btn{
            padding: .35rem .55rem;  /* smaller on mobile */
            font-size: .85rem;
        }
        /* ===== DataTable Header Style ===== */
        #tblProducts thead th {
            background-color: #3b5bdb;
            color: #fff;
        }



        .upload-box{
            width: 140px;
            height: 140px;
            border: 2px dashed #cbd5e1;
            border-radius: 12px;
            display:flex;
            align-items:center;
            justify-content:center;
            cursor:pointer;
            background:#fff;
            overflow:hidden;
        }
        #uploadPreview{
            width:100%;
            height:100%;
            display:flex;
            align-items:center;
            justify-content:center;
        }
        .upload-placeholder{ text-align:center; }
        .upload-placeholder .plus{
            font-size:42px;
            color:#64748b;
            font-weight:600;
            line-height:1;
        }
        .upload-box img{
            width:100%;
            height:100%;
            object-fit:cover;
            display:block;
        }
        .status-pill{
            display:inline-block;
            padding:.22rem .6rem;
            border-radius:999px;
            font-size:.8rem;
            color:#fff;
        }
        .pill-active{ background:#198754; }
        .pill-inactive{ background:#6c757d; }
        .thumb{
            width:56px;
            height:36px;
            object-fit:cover;
            border-radius:8px;
            border:1px solid #eee;
        }
    </style>
</head>

<body>
<section layout:fragment="content" th:with="title='Products', activeMenu='products'">

    <div class="d-flex justify-content-between align-items-center mb-3">
        <h3 class="mb-0">Product Management</h3>
        <button class="btn btn-primary" id="btnAdd">
            <i class="bi bi-plus-circle"></i> Add Product
        </button>
    </div>

    <!-- FILTER BAR -->
<!--    <div class="card shadow-sm mb-3">-->
<!--        <div class="card-body">-->
<!--            <div class="row g-3 align-items-end">-->
<!--                <div class="col-12 col-md-4">-->
<!--                    <label class="form-label">Filter Category</label>-->
<!--                    <select class="form-select" id="filterCategory">-->
<!--                        <option value="">All Categories</option>-->
<!--                        <option th:each="c : ${categories}"-->
<!--                                th:value="${c.id}"-->
<!--                                th:text="${c.name}">-->
<!--                        </option>-->
<!--                    </select>-->
<!--                </div>-->

<!--                <div class="col-12 col-md-4">-->
<!--                    <label class="form-label">Filter Status</label>-->
<!--                    <select class="form-select" id="filterStatus">-->
<!--                        <option value="">All</option>-->
<!--                        <option value="true">Active</option>-->
<!--                        <option value="false">Inactive</option>-->
<!--                    </select>-->
<!--                </div>-->

<!--                <div class="col-12 col-md-4 d-flex gap-2">-->
<!--                    <button class="btn btn-outline-primary w-100" id="btnApply">Apply</button>-->
<!--                    <button class="btn btn-outline-secondary w-100" id="btnReset">Reset</button>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->

    <!-- TABLE -->
    <div class="card shadow-sm">
        <div class="card-body table-responsive">
            <table id="tblProducts" class="table table-hover align-middle w-100">
                <thead >
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Category</th>
                    <th>Brand</th>
                    <th>Qty</th>
                    <th>Price</th>
                    <th>Image</th>
                    <th>Status</th>
                    <th>Create</th>
                    <th class="col-action">Action</th>
                </tr>
                </thead>
            </table>
        </div>
    </div>

    <!-- MODAL -->
    <div class="modal fade" id="productModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">

                <div class="modal-header">
                    <h5 class="modal-title" id="modalTitle">Add Product</h5>
                    <button class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <form id="productForm" enctype="multipart/form-data">
                    <div class="modal-body">
                        <input type="hidden" id="id"/>

                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label">Name</label>
                                <input class="form-control" id="name" required>
                            </div>

                            <div class="col-md-6">
                                <label class="form-label">Brand</label>
                                <input class="form-control" id="brand">
                            </div>

                            <div class="col-md-6">
                                <label class="form-label">Category</label>
                                <select class="form-select" id="categoryId" required>
                                    <option th:each="c : ${categories}" th:value="${c.id}" th:text="${c.name}"></option>
                                </select>
                            </div>

                            <div class="col-md-3">
                                <label class="form-label">Price</label>
                                <input class="form-control" id="price" type="number" step="0.01" required>
                            </div>

                            <div class="col-md-3">
                                <label class="form-label">Discount</label>
                                <input class="form-control" id="discount" type="number" step="0.01" value="0">
                            </div>

                            <div class="col-md-3">
                                <label class="form-label">Qty</label>
                                <input class="form-control" id="stock" type="number" required>
                            </div>

                            <div class="col-md-3">
                                <label class="form-label">Status</label>
                                <select class="form-select" id="active">
                                    <option value="true">Active</option>
                                    <option value="false">Inactive</option>
                                </select>
                            </div>

                            <div class="col-12">
                                <label class="form-label">Description</label>
                                <textarea class="form-control" id="description" rows="3"></textarea>
                            </div>

                            <div class="col-12">
                                <label class="form-label d-block">Image</label>

                                <label class="upload-box">
                                    <input type="file" id="image" accept="image/*" hidden>
                                    <div id="uploadPreview">
                                        <div class="upload-placeholder">
                                            <div class="plus">+</div>
                                            <div class="small text-muted">Upload</div>
                                        </div>
                                    </div>
                                </label>

                                <div class="small text-muted mt-2">Upload jpg / png / webp</div>
                            </div>
                        </div>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button class="btn btn-primary" type="submit">Save</button>
                    </div>
                </form>

            </div>
        </div>
    </div>

    <script th:src="@{/js/admin-products.js}"></script>
</section>
</body>
</html>